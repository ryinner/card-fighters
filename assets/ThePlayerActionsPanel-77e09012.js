var F=Object.defineProperty;var O=(t,e,s)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var o=(t,e,s)=>(O(t,typeof e!="symbol"?e+"":e,s),s);import{d as A,e as m,c as _,b as i,r as P,f as B,T,o as r,_ as k,a as x,x as I,y as j,w as C,t as b,l as H,F as v,n as g,u as w,C as E,k as D,E as S,G as V}from"./index-2ca17e1d.js";import{A as y}from"./cards.map-46f35cb5.js";const q={key:0,class:"modal"},N={class:"modal__content"},z={class:"modal__header"},G={class:"modal__body"},L=A({__name:"BaseModal",props:{isOpen:{type:Boolean}},emits:["open","close"],setup(t,{emit:e}){return(s,a)=>(r(),m(T,{to:"body"},[s.isOpen?(r(),_("div",q,[i("div",{class:"modal__background",onClick:a[0]||(a[0]=d=>e("close"))}),i("div",N,[i("div",z,[P(s.$slots,"header",{},void 0,!0)]),i("div",G,[P(s.$slots,"body",{},void 0,!0)])])])):B("",!0)]))}});const ve=k(L,[["__scopeId","data-v-88e06f84"]]),U="/card-fighters/assets/free-icon-heart-8298449-f078d28a.png",W="/card-fighters/assets/free-icon-sword-65741-2fdbd9df.png";class M{constructor(e,s){o(this,"name");o(this,"power");o(this,"haveBeenActivated");this.name=e,this.power=s,this.haveBeenActivated=!1}get isActivated(){return this.haveBeenActivated}activate(e){!this.haveBeenActivated&&this.tryAction(e)&&(this.haveBeenActivated=!0)}reactivate(){this.haveBeenActivated=!1}}class J extends M{constructor(e){super(y.attack,e)}tryAction(e){return e.isAlive?(e.takeDamage(this.power),!0):!1}}class K extends M{constructor(e){super(y.heal,e)}tryAction(e){return e.isAlive?(e.takeHeal(this.power),!0):!1}}function Q(t){const e={};let s;if(t.forEach(d=>{const{quantity:h=1,power:n=1,name:u}=d;if(h<=0)throw new Error("Actions quantity can't be less 1");for(let f=0;f<h;f++){let p;switch(u){case y.attack:p=new J(n),s=W;break;case y.heal:p=new K(n),s=U;break}let l=e[u];if(l||(e[u]={actions:[],image:s},l=e[u]),l&&(l.actions.push(p),!l.actions.length))throw new Error("Cards actions length is zero or undefined")}}),!a(e))throw new Error("No actions for cards");return e;function a(d){return Object.keys(d).length>0}}var c=(t=>(t.takeDamage="takeDamage",t.heal="heal",t.die="die",t))(c||{});function X(){const t={};if(Object.values(c).forEach(s=>{t[s]=[]}),e(t))return t;throw new Error("Invalid eventsHandlers");function e(s){return Object.keys(s).length===Object.keys(c).length}}class ${constructor(e){o(this,"name");o(this,"image");o(this,"actions");o(this,"maxHealPoints");o(this,"healPoints");o(this,"eventsHandlers");this.healPoints=e.healthPoints,this.maxHealPoints=e.healthPoints,this.name=e.name,this.image=e.image,this.actions=Q(e.actions),this.eventsHandlers=X()}get hp(){return this.healPoints}set hp(e){e<=0?this.die():(this.healPoints=e>this.maxHealPoints?this.maxHealPoints:e,this.fireEvent(c.heal,e))}get isAlive(){return this.hp>0}takeDamage(e){this.hp-=e,this.fireEvent(c.takeDamage,e)}takeHeal(e){this.isAlive&&(this.hp+=e,this.fireEvent(c.heal,e))}addHandler(e,s){this.eventsHandlers[e].push(s)}clearHandlers(){Object.keys(this.eventsHandlers).forEach(e=>{this.eventsHandlers[e]=[]})}fireEvent(e,s){this.eventsHandlers[e].forEach(a=>{a(s)})}die(){this.healPoints=0,this.fireEvent(c.die)}}class Y extends ${constructor(e){super(e)}}class Z extends ${constructor(e){super(e)}}function me(t){switch(t.type){case"warrior":return new Z(t);case"healer":return new Y(t)}}const R={class:"card-fighter__stats"},ee={class:"card-fighter__hp",title:"hp"},te={class:"card-fighter__portrait"},se=["src","alt"],ae={class:"card-fighter__text"},ne={class:"card-fighter__actions"},ie=["src","alt"],re=A({__name:"CardFighter",props:{fighter:{},isPlayer:{type:Boolean},isSelected:{type:Boolean}},setup(t){const e=t,s=x(!1),a=()=>{Object.values(c).forEach(n=>{e.fighter.addHandler(n,()=>{s.value=n,d()})})},d=()=>{setTimeout(()=>{s.value=!1},1e3)},h=()=>{e.fighter.clearHandlers()};return I(a),j(h),(n,u)=>(r(),m(E,{name:"card-fighter-dying"},{default:C(()=>[i("div",{ref:"cardFighterElement",class:g(["card-fighter",{"card-fighter--player":n.isPlayer,"card-fighter--enemy":!n.isPlayer,"card-fighter--selected":n.isSelected,"card-fighter--damaged":s.value===w(c).takeDamage,"card-fighter--healed":s.value===w(c).heal}])},[i("div",R,[i("div",ee,b(n.fighter.hp),1)]),i("div",te,[i("img",{src:n.fighter.image,alt:n.fighter.name,class:"card-fighter__image"},null,8,se)]),i("div",ae,b(n.fighter.name),1),i("div",ne,[(r(!0),_(v,null,H(n.fighter.actions,(f,p)=>(r(),_(v,{key:p},[(r(!0),_(v,null,H(f.actions,l=>(r(),_("img",{key:l.name,src:f.image,alt:l.name,class:g([{"card-fighter__action-icon--activated":l.isActivated},"card-fighter__action-icon"])},null,10,ie))),128))],64))),128))])],2)]),_:1}))}});const ge=k(re,[["__scopeId","data-v-f43343b1"]]),oe=["src"],ce={class:"action-icon__count"},le=A({__name:"ActionIcon",props:{action:{}},setup(t){const e=t,s=D(()=>e.action.actions.filter(a=>!a.isActivated).length);return(a,d)=>(r(),_("div",{class:g(["action-icon",{"action-icon--disabled":s.value===0}])},[i("img",{class:"action-icon__image",src:a.action.image},null,8,oe),i("span",ce,b(s.value),1)],2))}});const de=k(le,[["__scopeId","data-v-0a3a629b"]]),he={key:0,class:"player-actions-panel"},_e=A({__name:"ThePlayerActionsPanel",props:S({selectedCardFighter:{}},{selectedAction:{required:!0}}),emits:["update:selectedAction"],setup(t){const e=V(t,"selectedAction"),s=a=>{if(e.value===a){e.value=void 0;return}e.value=a};return(a,d)=>(r(),m(E,{name:"player-actions-panel"},{default:C(()=>[a.selectedCardFighter?(r(),_("div",he,[(r(!0),_(v,null,H(a.selectedCardFighter.actions,(h,n)=>(r(),m(de,{key:n,action:h,class:g(["player-actions-panel__item",{"player-actions-panel__item--active":h===e.value}]),onClick:u=>s(h)},null,8,["action","class","onClick"]))),128))])):B("",!0)]),_:1}))}});const ye=k(_e,[["__scopeId","data-v-5bcd13c4"]]);export{ve as B,ge as C,ye as T,K as a,J as b,me as c,Y as h,$ as w};
